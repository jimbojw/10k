<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>10k personal search engine</title>
<style type="text/css"></style>
</head>
<body>
<h1>10k personal search engine</h1>
<div class="search">
<h2><span>Search</span></h2>
<form><input type="text" name="search" /></form>
</div>
<div class="results">
<h2><span>Results</span></h2>
<div><dl></dl></div>
</div>
<div class="bookmarklet">
<h2><span>Bookmarklet</span></h2>
<p><a href="" title="Add to search engine" id="add"><span>add</span></a></p>
</div>
<div class="entries">
<h2><span>All pages</span></h2>
<div><p>none yet :/</p></div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>(function(n){var w=n.localStorage,k=n.JSON.stringify,o=n.JSON.parse;n=n["10kse"]={};for(var l="able|about|across|after|all|almost|also|among|and|any|are|because|been|but|can|cannot|could|dear|did|does|either|else|ever|every|for|from|get|got|had|has|have|her|hers|him|his|how|however|into|its|just|least|let|like|likely|may|might|most|must|neither|nor|not|off|often|only|other|our|own|rather|said|say|says|she|should|since|some|than|that|the|their|them|then|there|these|they|this|tis|too|twas|wants|was|were|what|when|where|which|while|who|whom|why|will|with|would|yet|you|your".split("|"),
x={},v=0,b=l.length;v<b;v++)x[l[v]]=true;n.get=function(i){return(i=w.getItem(i))?o(i):i};n.set=function(i,m){return w.setItem(i,k(m))};n.stop=x})(window);
(function(n){n.scanner=function(w,k,o){function l(s,y){var z;if(s.currentStyle)z=s.currentStyle[y];else if(w.getComputedStyle)z=b.getComputedStyle(s,null).getPropertyValue(y);return z}function x(s){return l(s,"display")!=="none"&&l(s,"visiblity")!=="hidden"}function v(s){var y=s.parentNode,z=y.parentNode,A=(s.innerText||s.textContent).replace(f," "),B=A.length;s=1;if(B>25){if(y[j]===o){y[j]=0;i[m++]=y}if(z[j]===o){z[j]=0;i[m++]=y}s+=A.split(",").length;A=B*0.01<<0;s+=A<4?A:3;y[j]+=s;z[j]+=s*0.5}}
var b=k.defaultView,i=[],m=0,j="10score",f=/\s+/g,a,c,d,q,g=k.getElementsByTagName("p");a=0;for(c=g.length;a<c;a++)v(g[a]);g=k.getElementsByTagName("div");var e,p=/<(a|blockquote|dl|div|img|ol|p|pre|table|ul|br)/i;a=0;for(c=g.length;a<c;a++){e=g[a];p.test(e.innerHTML)&&v(e)}p=null;var h;for(a=0;a<m;a++){c=i[a];g=c.getElementsByTagName("a");d=h=0;for(q=g.length;d<q;d++){e=g[d];h+=(e.innerText||e.textContent).length}c[j]=score=c[j]*(1-h/(c.innerText||c.textContent).length);if(!p||score>p[j])p=c}p=p||
k.body;g=k.getSelection()||"";h="h1,h2,h3,h4,h5,h6,pre,code".split(",");e=[];var t,r;a=0;for(c=h.length;a<c;a++){t=k.getElementsByTagName(h[a]);d=0;for(q=t.length;d<q;d++){r=t[d];x(r)&&e.push(r.textContent)}}d=[];p=[p];var u;q=/[a-z][a-z][a-z]/i;for(h=/button|link|noscript|script|style/i;c=p.shift();){t=c.childNodes;a=0;for(c=t.length;a<c;a++){r=t[a];u=r.nodeType;if(u===1&&!h.test(r.tagName)&&x(r))p[p.length]=r;else if(u===3){text=r.nodeValue;if(q.test(text))d[d.length]=text}}}w["10kse"].iframe.contentWindow.postMessage(JSON.stringify({url:k.location.href,
selection:g,title:k.title,priority:e.join(" "),content:d.join(" ")}),"*")}})(window["10kse"]);
(function(n){function w(b){var i,m,j,f=0,a,c={};m=b.split(x);b=0;for(i=m.length;b<i;b++){f++;j=m[b];a=j.toLowerCase();if(j.length>2&&!v[a]){(j=c[a])||(j=c[a]=[]);j[j.length]=f}}return c}function k(b,i,m){if(m&&/[a-z]/i.test(m)){m=w(m);var j,f,a;for(j in m){f=o("W-"+j)||{};(a=f[b])||(a=f[b]={});a[i]=m[j];l("W-"+j,f)}}}var o=n.get,l=n.set,x=/[^0-9a-z_]+/i,v=n.stop;n.extract=w;n.indexer=function(b){var i,m=o("URL-"+b.url);if(m){i=m.id;if(b.content!==m.text||b.title!==m.title)l("URL-"+b.url,{id:i,text:b.content,
title:b.title})}else{i=o("COUNT")||0;l("ID-"+i,b.url);l("COUNT",i+1);l("URL-"+b.url,{id:i,text:b.content,title:b.title})}k(i,"s",b.selection);k(i,"t",b.title);k(i,"p",b.priority);k(i,"c",b.content)}})(window["10kse"],window);
(function(n,w,k,o){var l=o.get,x=o.set,v=w.location.href;l=l("key");if(!l){l=Math.random();x("key",l)}v=JSON.stringify(v.replace(/#.*|$/,"#"+l));k("#add").attr("href",("javascript:("+function(b,i,m){var j=b["10kse"];j||(j=b["10kse"]={});if(j.scanner)return j.scanner();b.addEventListener("message",function(c){if(m.substr(0,c.origin.length)===c.origin){j.scanner=new Function(c.data);j.scanner()}},false);var f=j.iframe=i.createElement("iframe");b=f.style;f.setAttribute("src",m);b.width=b.height="1px";
b.top=b.left="-2px";b.border="none";b.position="absolute";var a=false;f.onload=f.onreadystatechange=function(){if(!a&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){a=true;f.onload=f.onreadystatechange=null;f.contentWindow.postMessage("script",m)}};i.body.appendChild(f)}+")(window,document,"+v+")").replace(/\s+/g," ")).click(function(b){b.preventDefault();alert("1. Drag this link to your bookmarks,\n2. Navigate to another page,\n3. Click the bookmarklet to add that page to your search engine.")});
n!==n.top&&w.location.hash==="#"+l&&n.addEventListener("message",function(b){b.data==="script"?b.source.postMessage("("+o.scanner+")(window,document)","*"):o.indexer(JSON.parse(b.data))},false)})(window,document,jQuery,window["10kse"]);
(function(n,w,k){if(k===k.top){n=n.get;k=n("COUNT")||0;var o,l;if(k>0)for(var x=w("<ul></ul>").appendTo(w(".entries").find("div").empty());k>0;){k--;o=n("ID-"+k);l=n("URL-"+o);w("<li><a></a></li>").find("a").attr("href",o).attr("title",l.title).text(l.title).end().appendTo(x)}}})(window["10kse"],jQuery,window);
(function(n,w,k,o,l){function x(f,a,c){if(c===l)c=true;f=j.text(f).html();var d={},q={},g=[],e,p,h,t,r,u;e=0;for(p=a.length;e<p;e++){h=a[e];t=h.length;if(t>2&&!d[h]){d[h]=true;for(u=r=0;r<3;){u=f.indexOf(h,u);if(u===-1)break;var s=f.charAt(u-1).toLowerCase(),y=f.charAt(u+t).toLowerCase();if((s<"a"||s>"z")&&(y<"a"||y>"z")){r++;g[g.length]=u;q[u]=h}u+=t}}}g.sort();a=[];d=0;t=g.length;for(e=u=0;d<200&&e<=t;){p=g[e];h=e<t?f.substr(u,p-u):f.substr(u);r=h.length;if(c)if(e===0){if(r>50)h="... "+h.substr(r-
50-4)}else if(e===t){if(r>50)h=h.substr(0,46)+" ..."}else if(r>100)h=h.substr(0,47)+" ... "+h.substr(r-50-3);a[a.length]=h;d+=h.length;if(e<t){h=q[p];a[a.length]="<b>"+h+"</b>";d+=h.length;u=p+h.length}e++}if(d>=200)a[a.length]=" ...";return a.join("")}var v=k.get,b=k.stop,i=o(".results dl"),m=o(".search input"),j=o("<div></div>");o("form").submit(function(f){f.preventDefault();f=(m.val()||"").toLowerCase().split(/[^a-z0-9_]/);var a,c,d,q={},g,e={};a=0;for(c=f.length;a<c;a++){d=f[a];if(!e[d])if(d=
e[d]=v("W-"+d))for(g in d)q[g]+=1}i.empty();for(g in q){a=v("ID-"+g);c=v("URL-"+a);e=c.text;i.append(o("<dt><a></a></dt>").find("a").attr("href",a).attr("title",c.title).text(x(c.title,f,false)).end(),o("<dd></dd>").html(x(e,f)))}});o(function(){m.focus()});k.wordcount=function(f,a,c,d){d||(d={});for(var q={},g,e,p,h=0,t=a.length;h<t;h++){g=a[h];if(g.length>2&&!b[g]){g=d[g]||(d[g]=v("W-"+g));for(e in f)if(p=g[e])if(p=p[c]){if(q[e]===l)q[e]=0;q[e]+=+p.length}}}return q};k.normalize=function(f,a){if(a===
l)a=1;var c={},d,q,g,e;for(d in f){e=c[d]=f[d]*a;if(q===l||e>q)q=e;if(g===l||e<g)g=e}for(d in c)c[d]=(c[d]-g)*(1/(q-g));return c};k.highlight=x})(window,document,window["10kse"],jQuery);
</script>
</body>
</html>

