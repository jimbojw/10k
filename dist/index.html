<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>10k personal search engine</title>
<style type="text/css">body{font-family:arial;width:600px;margin:0 auto;background:#cef;}h1{background:#036;color:white;padding:1em 0;font-size:2.5em;text-align:center;}dd{margin-left:0;margin-bottom:1.5em;}dt{font-size:1.1em;}a,a:visited{color:blue;}input{width:100%;}body>div{background:white;border:1px solid #ccc;margin-bottom:1em;padding:0 1em 1em;}ul{list-style-type:square;color:#09f;}ul li{margin-bottom:.5em;}.auto{position:absolute;background:#fff;padding:0;margin:0;border:none;}.auto ul{margin:0;padding:0;list-style-type:none;border:1px solid #ccc;}.auto li{margin:0;padding:.25em .5em;}.auto .selected{background:#f0f0f0;}</style>
</head>
<body>
<!--html-->
<h1><span>10k personal search engine<span></h1>
<div class="search">
<h2><span>Search</span></h2>
<form><input type="text" name="search" autocomplete="off" /></form>
</div>
<div class="results">
<h2><span>Results</span></h2>
<div><dl></dl></div>
</div>
<div class="bookmarklet">
<h2><span>Bookmarklet</span></h2>
<p><a href="" title="Add to search engine" id="add"><span>add</span></a></p>
</div>
<div class="entries">
<h2><span>All pages</span></h2>
<div><p>none yet :/</p></div>
</div>
<!--/html-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>(function(l){var r=l.localStorage,j=l.JSON.stringify,m=l.JSON.parse;l=l["10kse"]={};for(var h="able|about|across|after|all|almost|also|among|and|any|are|because|been|but|can|cannot|could|dear|did|does|either|else|ever|every|for|from|get|got|had|has|have|her|hers|him|his|how|however|into|its|just|least|let|like|likely|may|might|most|must|neither|nor|not|off|often|only|other|our|own|rather|said|say|says|she|should|since|some|than|that|the|their|them|then|there|these|they|this|tis|too|twas|wants|was|were|what|when|where|which|while|who|whom|why|will|with|would|yet|you|your".split("|"),
k={},i=0,b=h.length;i<b;i++)k[h[i]]=true;l.asc=function(a,c){return a-c};l.get=function(a){return(a=r.getItem(a))?m(a):a};l.set=function(a,c){return r.setItem(a,j(c))};l.stop=k})(window);
(function(l){l.scanner=function(r,j,m){function h(t,x){var z;if(t.currentStyle)z=t.currentStyle[x];else if(r.getComputedStyle)z=b.getComputedStyle(t,null).getPropertyValue(x);return z}function k(t){return h(t,"display")!=="none"&&h(t,"visiblity")!=="hidden"}function i(t){var x=t.parentNode,z=x.parentNode,A=(t.innerText||t.textContent).replace(f," "),B=A.length;t=1;if(B>25){if(x[d]===m){x[d]=0;a[c++]=x}if(z[d]===m){z[d]=0;a[c++]=x}t+=A.split(",").length;A=B*0.01<<0;t+=A<4?A:3;x[d]+=t;z[d]+=t*0.5}}
var b=j.defaultView,a=[],c=0,d="10score",f=/\s+/g,g,e,n,s,p=j.getElementsByTagName("p");g=0;for(e=p.length;g<e;g++)i(p[g]);p=j.getElementsByTagName("div");var u,q=/<(a|blockquote|dl|div|img|ol|p|pre|table|ul|br)/i;g=0;for(e=p.length;g<e;g++){u=p[g];q.test(u.innerHTML)&&i(u)}q=null;var v;for(g=0;g<c;g++){e=a[g];p=e.getElementsByTagName("a");n=v=0;for(s=p.length;n<s;n++){u=p[n];v+=(u.innerText||u.textContent).length}e[d]=score=e[d]*(1-v/(e.innerText||e.textContent).length);if(!q||score>q[d])q=e}q=q||
j.body;p=j.getSelection()||"";v="h1,h2,h3,h4,h5,h6,pre,code".split(",");u=[];var y,o;g=0;for(e=v.length;g<e;g++){y=j.getElementsByTagName(v[g]);n=0;for(s=y.length;n<s;n++){o=y[n];k(o)&&u.push(o.textContent)}}n=[];q=[q];var w;s=/[a-z][a-z][a-z]/i;for(v=/button|link|noscript|script|style/i;e=q.shift();){y=e.childNodes;g=0;for(e=y.length;g<e;g++){o=y[g];w=o.nodeType;if(w===1&&!v.test(o.tagName)&&k(o))q[q.length]=o;else if(w===3){text=o.nodeValue;if(s.test(text))n[n.length]=text}}}r["10kse"].iframe.contentWindow.postMessage(JSON.stringify({url:j.location.href,
selection:p,title:j.title,priority:u.join(" "),content:n.join(" ")}),"*")}})(window["10kse"]);
(function(l){function r(b){var a,c,d,f=0,g,e={};c=b.split(k);b=0;for(a=c.length;b<a;b++){f++;d=c[b];g=d.toLowerCase();if(d.length>2&&!i[g]){(d=e[g])||(d=e[g]=[]);d[d.length]=f}}return e}function j(b,a,c){if((c=""+c)&&/[a-z]/i.test(c)){c=r(c);var d,f,g;for(d in c){f=m("W-"+d)||{};(g=f[b])||(g=f[b]={});g[a]=c[d];h("W-"+d,f)}}}var m=l.get,h=l.set,k=/[^0-9a-z_]+/i,i=l.stop;l.extract=r;l.indexer=function(b){var a,c=m("URL-"+b.url);if(c){a=c.id;if(b.content!==c.text||b.title!==c.title)h("URL-"+b.url,{id:a,
text:b.content,title:b.title})}else{a=m("COUNT")||0;h("ID-"+a,b.url);h("COUNT",a+1);h("URL-"+b.url,{id:a,text:b.content,title:b.title})}j(a,"s",b.selection);j(a,"t",b.title);j(a,"p",b.priority);j(a,"c",b.content)}})(window["10kse"],window);
(function(l,r,j,m){var h=m.get,k=m.set,i=r.location.href;h=h("K");if(!h){h=Math.random();k("K",h)}i=JSON.stringify(i.replace(/#.*|$/,"#"+h));k="javascript:("+(function(b,a,c){var d=b["10kse"];d||(d=b["10kse"]={});if(d.scanner)return d.scanner();b.addEventListener("message",function(e){if(c.substr(0,e.origin.length)===e.origin){d.scanner=new Function(e.data);d.scanner()}},false);var f=d.iframe=a.createElement("iframe");b=f.style;f.setAttribute("src",c);b.width=b.height="1px";b.top=b.left="-2px";b.border=
"none";b.position="absolute";var g=false;f.onload=f.onreadystatechange=function(){if(!g&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g=true;f.onload=f.onreadystatechange=null;f.contentWindow.postMessage("script",c)}};a.body.appendChild(f)}+"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ")+")(window,document,"+i+")";j("#add").attr("href",k).click(function(b){b.preventDefault();alert("1. Drag this link to your bookmarks,\n2. Navigate to another page,\n3. Click the bookmarklet to add that page to your search engine.")});
l!==l.top&&r.location.hash==="#"+h&&l.addEventListener("message",function(b){b.data==="script"?b.source.postMessage("("+m.scanner+")(window,document)","*"):m.indexer(JSON.parse(b.data))},false)})(window,document,jQuery,window["10kse"]);
(function(l,r,j){if(j===j.top){l=l.get;j=l("COUNT")||0;var m,h;if(j>0)for(var k=r("<ul></ul>").appendTo(r(".entries").find("div").empty());j>0;){j--;m=l("ID-"+j);h=l("URL-"+m);r("<li><a></a></li>").find("a").attr("href",m).attr("title",h.title).text(h.title).end().appendTo(k)}}})(window["10kse"],jQuery,window);
(function(l,r){var j=l.get;l.wordcount=function(m,h,k,i){i||(i={});for(var b={},a,c,d,f=0,g=h.length;f<g;f++){a=h[f];if(a.length>2&&!stop[a]){c=i[a];if(c===r)c=i[a]=j("W-"+a);if(c)for(d in m)if(a=c[d])if(a=a[k]){if(b[d]===r)b[d]=0;b[d]+=+a.length}}}return b};l.normalize=function(m,h,k){if(h===r)h=1;if(k===r)k=0.5;var i={},b,a,c,d;for(b in m){d=i[b]=m[b]*h;if(a===r||d>a)a=d;if(c===r||d<c)c=d}if(a===c){for(b in i)i[b]=k;return i}for(b in i)i[b]=(i[b]-c)*(1/(a-c));return i};l.topdistance=function(m,
h,k,i){i||(i={});var b={},a,c,d,f;for(d in m){f=null;for(var g=0,e=h.length;g<e;g++){a=h[g];if(a.length>2&&!stop[a]){c=i[a];if(c===r)c=i[a]=j("W-"+a);if(c)if(a=c[d])if(a=a[k])if(f===null||a[0]<f)f=a[0]}}if(f!==null)b[d]=f}return b}})(window["10kse"]);
(function(l,r,j){var m=r("<div></div>");l.highlight=function(h,k,i){if(i===j)i=true;h=m.text(h).html();var b=h.toLowerCase(),a={},c={},d=[],f,g,e,n,s,p;f=0;for(g=k.length;f<g;f++){e=k[f].toLowerCase();n=e.length;if(n>2&&!a[e]){a[e]=true;for(p=s=0;s<3;){p=b.indexOf(e,p);if(p===-1)break;var u=h.charAt(p-1).toLowerCase(),q=h.charAt(p+n).toLowerCase();if((u<"a"||u>"z")&&(q<"a"||q>"z")){s++;d[d.length]=p;c[p]=e}p+=n}}}d.sort(l.asc);k=[];b=0;n=d.length;for(f=p=0;b<200&&f<=n;){a=d[f];e=f<n?h.substr(p,a-
p):h.substr(p);g=e.length;if(i)if(f===n){if(g>50)e=e.substr(0,46)+" ..."}else if(f===0){if(g>50)e="... "+e.substr(g-50-4)}else if(g>100)e=e.substr(0,47)+" ... "+e.substr(g-50-3);k[k.length]=e;b+=e.length;if(f<n){e=c[a];k[k.length]="<b>"+h.substr(a,e.length)+"</b>";b+=e.length;p=a+e.length}f++}if(b>=200&&f<=n)k[k.length]=" ...";return k.join("")}})(window["10kse"],jQuery);
(function(l,r){var j=l.localStorage,m,h;r.suggest=function(k){k=k.replace(/^\s+|\s$/g,"").toLowerCase();if(!k||!j.length)return[];var i;i=j.length;if(i!==h){h=i;m=[];for(var b=i=0;b<h;b++){var a=j.key(b);if(a.indexOf("W-")===0)m[i++]=a.substr(2)}m.sort()}i=m;b=i.length;a=0;for(var c=b-1,d;c-a>1;){d=a+(c-a>>1);if(i[d]<=k)a=d;else c=d}if(i[a].indexOf(k)===0)a=a;else if(i[c].indexOf(k)===0)a=c;else return[];for(b=a+16>b?b-1:a+15;i[b].indexOf(k)!==0;)b--;return i.slice(a,b+1)}})(window,window["10kse"]);
(function(l,r,j){function m(f){function g(){y(v);v=null;if(q){var o=q.text(),w=n.val(),t=w.lastIndexOf(" ")+1;n.get(0).value=u=w.substr(0,t)+o}s.hide()}function e(){if(p.find("li").length){var o=n.offset();s.css({top:o.top+f.offsetHeight,left:o.left,width:f.offsetWidth});s.show()}}var n=j(f),s=j('<div class="auto"><ul></ul></div>').css({display:"none"}).appendTo(document.body),p=s.find("ul"),u="",q=null,v,y=l.clearTimeout;n.bind("change keyup",function(o){var w=n.val();o=o.which;if(w!==u){u=w;o=w.lastIndexOf(" ");
var t=w.substr(o<0?0:o).toLowerCase();if(t.length){v&&y(v);v=l.setTimeout(function(){y(v);v=null;var x=d(t);if(x&&x.length){p.empty();q=null;for(var z=0,A=x.length;z<A;z++)j("<li><span></span></li>").appendTo(p).find("span").html(x[z].split(t,2).join("<b>"+t+"</b>"));e()}else s.hide()},400)}else s.hide()}else if(o===h||o===i){if(q)if(o===h){w=q.prev();if(w.length){q.removeClass(c);q=w.addClass(c)}}else{w=q.next();if(w.length){q.removeClass(c);q=w.addClass(c)}}else q=p.find("li").eq(0).addClass(c);
e()}else if(o===b||o===k)g();else o===a&&s.hide()}).parent("form").submit(g);p.mouseover(function(o){o=j(o.target);o=o.is("li")?o:o.parent("li");if(o=o.length?o:null){q&&q.get(0)!==o.get(0)&&q.removeClass(c);q=o.addClass(c)}}).click(g)}var h=38,k=39,i=40,b=13,a=27,c="selected",d=r.suggest;j(".search input").each(function(){m(this)});r.autocomplete=m})(window,window["10kse"],jQuery);
(function(l,r,j,m){var h=j.get,k=m(".results dl"),i=m(".search input");m("form").submit(function(b){b.preventDefault();b=(i.val()||"").toLowerCase().split(/[^a-z0-9_]/);var a,c,d,f={},g,e={};a=0;for(c=b.length;a<c;a++){d=b[a];if(!e[d])if(d=e[d]=h("W-"+d))for(g in d)f[g]=(f[g]||0)+1}a=j.wordcount;c=j.normalize;d=j.topdistance;e=[[1,c(f)],[1,c(a(f,b,"s",e))],[1,c(a(f,b,"t",e))],[1,c(a(f,b,"p",e))],[1,c(a(f,b,"c",e))],[1,c(d(f,b,"s",e),-1)],[1,c(d(f,b,"t",e),-1)],[1,c(d(f,b,"p",e),-1)],[1,c(d(f,b,"c",
e),-1)]];f={};a=0;for(c=e.length;a<c;a++){var n=e[a];d=n[0];n=n[1];for(g in n){f[g]||(f[g]=0);f[g]+=d*n[g]}}e=[];a=0;d={};var s;for(g in f){s=f[g];n=d[s]||(d[s]=[]);n[n.length]=g;e[a++]=s}e.sort(j.asc);e.reverse();var p=j.highlight,u=null;k.empty();a=0;for(c=e.length;a<c;a++){s=e[a];if(s!==u){u=s;n=d[s];s=0;for(var q=n.length;s<q;s++){g=n[s];var v=h("ID-"+g),y=h("URL-"+v),o=y.text;k.append(m("<dt><a></a></dt>").find("a").attr("href",v).attr("title",y.title).html(p(y.title,b,false)).end(),m("<dd><p></p></dd>").find("p").html(p(o,
b)).end().append("<p><strong>Score: "+(f[g]+"").substr(0,4)+"</strong></p>"))}}}});m(function(){i.focus()})})(window,document,window["10kse"],jQuery);
</script>
</body>
</html>

