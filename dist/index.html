<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>10k personal search engine</title>
<style type="text/css">body{font-family:'Helvetica Neue',Arial,'Liberation Sans',FreeSans,sans-serif;width:600px;margin:0 auto;background:#eee;}h1{background:#036;color:white;padding:1em 0;font-size:2.5em;text-align:center;background-image:-moz-linear-gradient(center bottom,#1b4080 32%,#486bb3 72%);background-image:-webkit-gradient(linear,left bottom,left top,color-stop(0.32,#1b4080),color-stop(0.72,#486bb3));-moz-border-radius:8px;border-radius:8px;text-shadow:#333 1px 1px 1px;}dt{font-size:1.1em;margin-bottom:0;}dd{margin-left:0;margin-bottom:2.5em;}dd p{margin:1em 0;}a,a:visited{color:#06c;}input[type=text]{width:100%;border:1px solid #aaa;}input[type=submit],input[type=button]{border:1px solid #aaa;background-image:-moz-linear-gradient(center bottom,#ddd 32%,#f3f3f3 72%);background-image:-webkit-gradient(linear,left bottom,left top,color-stop(0.32,#ddd),color-stop(0.72,#f3f3f3));-moz-border-radius:3px;border-radius:2px;padding:.25em 1em;font-size:medium;}form p{text-align:center;}.pane{clear:both;background:white;border:1px solid #aaa;margin-bottom:1em;padding:0 1em 1em;-moz-border-radius:8px;border-radius:8px;display:none;}.pane.selected{display:inherit;}ul{list-style-type:square;color:#06c;}li{margin-bottom:.5em;}#add{display:block;margin:1em auto;width:5em;background:#f30;color:white;padding:.5em;font-size:2.5em;text-align:center;background-image:-moz-linear-gradient(center bottom,#c92200 32%,#f30 72%);background-image:-webkit-gradient(linear,left bottom,left top,color-stop(0.32,#c92200),color-stop(0.72,#f30));-moz-border-radius:8px;border-radius:8px;text-shadow:#333 1px 1px 1px;text-decoration:none;}nav ul{margin:0 1em;padding:0;list-style-type:none;}nav li{float:left;margin:0 .6em;padding:.25em 1em;background:#ddd;-moz-border-radius-topRight:6px;-moz-border-radius-topLeft:6px;border-top-right-radius:6px;border-top-left-radius:6px;border:1px solid #aaa;border-bottom:none;color:#444;cursor:pointer;}nav .selected{color:#06c;background:#fff;z-index:1;position:relative;top:1px;}.auto{position:absolute;background:#fff;padding:0;margin:0;border:none;}.auto ul{margin:0;padding:0;list-style-type:none;border:1px solid #ccc;}.auto li{margin:0;padding:.25em .5em;}.auto .selected{background:#f0f0f0;}</style>
</head>
<body>
<!--html-->
<div class="container">
<h1><span>10k personal search engine<span></h1>
<nav>
<ul>
<li class="welcome">welcome</li>
<li class="search">search</li>
<li class="allpages">all pages</li>
<li class="prefs">preferences</li>
<li class="about">about</li>
</ul>
</nav>
<div class="search pane">
<div>
<h2><span>Search</span></h2>
<form>
<p><input type="text" name="search" autocomplete="off" /></p>
<p>
<input type="submit" name="submit" value="Search" />
<input type="button" name="web" value="Web" />
</p>
</form>
</div>
<div class="results"><dl></dl></div>
</div>
<div class="welcome pane">
<h2><span>Welcome</span></h2>
<p>The 'add' button below is a <a href="http://en.wikipedia.org/wiki/Bookmarklet" title="bookmarklet">bookmarklet</a>.</p>
<ol>
	<li>Drag it to your bookmarks toolbar or add it to your favorites.</li>
	<li>When you're on a page you want to add, click the bookmark.</li>
	<li>That page will now appear in your search results!</li>
</ol>
<p><a href="" title="Add to search engine" id="add"><span>add</span></a></p>
</div>
<div class="allpages pane">
<h2><span>All pages</span></h2>
<div><p>none yet :/</p></div>
</div>
<div class="prefs pane">
<h2><span>Preferences</span></h2>
<p>TBD</p>
</div>
<div class="about pane">
<h2><span>About</span></h2>
<p>TBD</p>
</div>
</div>
<!--/html-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>(function(l){var q=l.localStorage,k=l.JSON.stringify,o=l.JSON.parse;l=l["10kse"]={};for(var h="able|about|across|after|all|almost|also|among|and|any|are|because|been|but|can|cannot|could|dear|did|does|either|else|ever|every|for|from|get|got|had|has|have|her|hers|him|his|how|however|into|its|just|least|let|like|likely|may|might|most|must|neither|nor|not|off|often|only|other|our|own|rather|said|say|says|she|should|since|some|than|that|the|their|them|then|there|these|they|this|tis|too|twas|wants|was|were|what|when|where|which|while|who|whom|why|will|with|would|yet|you|your".split("|"),
e={},i=0,f=h.length;i<f;i++)e[h[i]]=true;l.asc=function(a,b){return a-b};l.get=function(a){return(a=q.getItem("10kse-"+a))?o(a):a};l.set=function(a,b){return q.setItem("10kse-"+a,k(b))};l.stop=e})(window);
(function(l,q){function k(f){var a=q(".pane."+f+", nav ."+f);if(!a.length)throw"no such tab named '"+f+"'";i&&i.removeClass(e);i=a.addClass(e);h("TAB",f)}var o=l.get,h=l.set,e="selected",i;k(o("TAB")||"welcome");q("nav li").click(function(){q(this).hasClass("active")||k(this.className)});l.showtab=k})(window["10kse"],jQuery);
(function(l){function q(h){for(var e=this.data,i,f,a=0,b=h.length;a<b;a++){f=h.charAt(a);(i=e[f])||(i=e[f]={});e=i}e.$=1}function k(h){for(var e=this.data,i,f=0,a=h.length;f<a;f++){i=h.charAt(f);e=e[i];if(!e)return null;e=e}return e}function o(h){var e=this.find(h);if(!e)return[];for(var i=[[h,e]],f=[],a=0,b;i.length;){e=i.shift();h=e[0];e=e[1];if(e.$)f[a++]=h;for(b in e)if(b!=="$")i[i.length]=[h+b,e[b]]}f.sort();return f}l.trie=function(h){return{add:q,data:h,find:k,match:o}}})(window["10kse"],jQuery);
(function(l){l.scanner=function(q,k,o){function h(t,y){var z;if(t.currentStyle)z=t.currentStyle[y];else if(q.getComputedStyle)z=f.getComputedStyle(t,null).getPropertyValue(y);return z}function e(t){return h(t,"display")!=="none"&&h(t,"visiblity")!=="hidden"}function i(t){var y=t.parentNode,z=y.parentNode,A=(t.innerText||t.textContent).replace(j," "),B=A.length;t=1;if(B>25){if(y[c]===o){y[c]=0;a[b++]=y}if(z[c]===o){z[c]=0;a[b++]=y}t+=A.split(",").length;A=B*0.01<<0;t+=A<4?A:3;y[c]+=t;z[c]+=t*0.5}}
var f=k.defaultView,a=[],b=0,c="10score",j=/\s+/g,g,d,m,s,r=k.getElementsByTagName("p");g=0;for(d=r.length;g<d;g++)i(r[g]);r=k.getElementsByTagName("div");var u,p=/<(a|blockquote|dl|div|img|ol|p|pre|table|ul|br)/i;g=0;for(d=r.length;g<d;g++){u=r[g];p.test(u.innerHTML)&&i(u)}p=null;var v;for(g=0;g<b;g++){d=a[g];r=d.getElementsByTagName("a");m=v=0;for(s=r.length;m<s;m++){u=r[m];v+=(u.innerText||u.textContent).length}d[c]=score=d[c]*(1-v/(d.innerText||d.textContent).length);if(!p||score>p[c])p=d}p=p||
k.body;r=k.getSelection()||"";v="h1,h2,h3,h4,h5,h6,pre,code".split(",");u=[];var x,n;g=0;for(d=v.length;g<d;g++){x=k.getElementsByTagName(v[g]);m=0;for(s=x.length;m<s;m++){n=x[m];e(n)&&u.push(n.textContent)}}m=[];p=[p];var w;s=/[a-z][a-z][a-z]/i;for(v=/button|link|noscript|script|style/i;d=p.shift();){x=d.childNodes;g=0;for(d=x.length;g<d;g++){n=x[g];w=n.nodeType;if(w===1&&!v.test(n.tagName)&&e(n))p[p.length]=n;else if(w===3){text=n.nodeValue;if(s.test(text))m[m.length]=text}}}q["10kse"].iframe.contentWindow.postMessage(JSON.stringify({url:k.location.href,
selection:r,title:k.title,priority:u.join(" "),content:m.join(" ")}),"*")}})(window["10kse"]);
(function(l){function q(a){var b,c,j,g=0,d,m={};c=a.split(e);a=0;for(b=c.length;a<b;a++){g++;j=c[a];d=j.toLowerCase();if(j.length>2&&!i[d]){(j=m[d])||(j=m[d]=[]);j[j.length]=g}}return m}function k(a,b,c,j){if((c=""+c)&&/[a-z]/i.test(c)){c=q(c);var g,d,m;for(g in c){d=o("W-"+g)||{};(m=d[a])||(m=d[a]={});m[b]=c[g];h("W-"+g,d);j[g]=1}}}var o=l.get,h=l.set,e=/[^0-9a-z_]+/i,i=l.stop,f=l.trie;l.extract=q;l.indexer=function(a){var b,c=o("URL-"+a.url);if(c){b=c.id;if(a.content!==c.text||a.title!==c.title)h("URL-"+
a.url,{id:b,text:a.content,title:a.title})}else{b=o("COUNT")||0;h("ID-"+b,a.url);h("COUNT",b+1);h("URL-"+a.url,{id:b,text:a.content,title:a.title})}c={};k(b,"s",a.selection,c);k(b,"t",a.title,c);k(b,"p",a.priority,c);k(b,"c",a.content,c);a=o("ALL")||{};b=f(a);var j;for(j in c)b.add(j);h("ALL",a)}})(window["10kse"],window);
(function(l,q,k,o){var h=o.get,e=o.set,i=q.location.href;h=h("K");if(!h){h=Math.random();e("K",h)}i=JSON.stringify(i.replace(/#.*|$/,"#"+h));e="javascript:("+(function(f,a,b){var c=f["10kse"];c||(c=f["10kse"]={});if(c.scanner)return c.scanner();f.addEventListener("message",function(d){if(b.substr(0,d.origin.length)===d.origin){c.scanner=new Function(d.data);c.scanner()}},false);var j=c.iframe=a.createElement("iframe");f=j.style;j.setAttribute("src",b);f.width=f.height="1px";f.top=f.left="-2px";f.border=
"none";f.position="absolute";var g=false;j.onload=j.onreadystatechange=function(){if(!g&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g=true;j.onload=j.onreadystatechange=null;j.contentWindow.postMessage("script",b)}};a.body.appendChild(j)}+"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ")+")(window,document,"+i+")";k("#add").attr("href",e).click(function(f){f.preventDefault();alert("1. Drag this link to your bookmarks,\n2. Navigate to another page,\n3. Click the bookmarklet to add that page to your search engine.")});
l!==l.top&&q.location.hash==="#"+h&&l.addEventListener("message",function(f){f.data==="script"?f.source.postMessage("("+o.scanner+")(window,document)","*"):o.indexer(JSON.parse(f.data))},false)})(window,document,jQuery,window["10kse"]);
(function(l,q,k){if(k===k.top){l=l.get;k=l("COUNT")||0;var o,h;if(k>0)for(var e=q("<ul></ul>").appendTo(q(".entries").find("div").empty());k>0;){k--;o=l("ID-"+k);h=l("URL-"+o);q("<li><a></a></li>").find("a").attr("href",o).attr("title",h.title).text(h.title).end().appendTo(e)}}})(window["10kse"],jQuery,window);
(function(l,q){var k=l.get;l.wordcount=function(o,h,e,i){i||(i={});for(var f={},a,b,c,j=0,g=h.length;j<g;j++){a=h[j];if(a.length>2&&!stop[a]){b=i[a];if(b===q)b=i[a]=k("W-"+a);if(b)for(c in o)if(a=b[c])if(a=a[e]){if(f[c]===q)f[c]=0;f[c]+=+a.length}}}return f};l.normalize=function(o,h,e){if(h===q)h=1;if(e===q)e=0.5;var i={},f,a,b,c;for(f in o){c=i[f]=o[f]*h;if(a===q||c>a)a=c;if(b===q||c<b)b=c}if(a===b){for(f in i)i[f]=e;return i}for(f in i)i[f]=(i[f]-b)*(1/(a-b));return i};l.topdistance=function(o,
h,e,i){i||(i={});var f={},a,b,c,j;for(c in o){j=null;for(var g=0,d=h.length;g<d;g++){a=h[g];if(a.length>2&&!stop[a]){b=i[a];if(b===q)b=i[a]=k("W-"+a);if(b)if(a=b[c])if(a=a[e])if(j===null||a[0]<j)j=a[0]}}if(j!==null)f[c]=j}return f}})(window["10kse"]);
(function(l,q,k){var o=q("<div></div>");l.highlight=function(h,e,i){if(i===k)i=true;h=o.text(h).html();var f=h.toLowerCase(),a={},b={},c=[],j,g,d,m,s,r;j=0;for(g=e.length;j<g;j++){d=e[j].toLowerCase();m=d.length;if(m>2&&!a[d]){a[d]=true;for(r=s=0;s<3;){r=f.indexOf(d,r);if(r===-1)break;var u=h.charAt(r-1).toLowerCase(),p=h.charAt(r+m).toLowerCase();if((u<"a"||u>"z")&&(p<"a"||p>"z")){s++;c[c.length]=r;b[r]=d}r+=m}}}c.sort(l.asc);e=[];f=0;m=c.length;for(j=r=0;f<200&&j<=m;){a=c[j];d=j<m?h.substr(r,a-
r):h.substr(r);g=d.length;if(i)if(j===m){if(g>50)d=d.substr(0,46)+" ..."}else if(j===0){if(g>50)d="... "+d.substr(g-50-4)}else if(g>100)d=d.substr(0,47)+" ... "+d.substr(g-50-3);e[e.length]=d;f+=d.length;if(j<m){d=b[a];e[e.length]="<b>"+h.substr(a,d.length)+"</b>";f+=d.length;r=a+d.length}j++}if(f>=200&&j<=m)e[e.length]=" ...";return e.join("")}})(window["10kse"],jQuery);
(function(l){var q=l.get,k=l.trie,o,h;l.suggest=function(e){e=e.replace(/^\s+|\s$/g,"").toLowerCase();var i=q("COUNT")||0;if(!e||!i)return[];if(i!==void 0){o=q("ALL");h=k(o)}return h.match(e).slice(0,15)}})(window["10kse"]);
(function(l,q,k){function o(j){function g(){x(v);v=null;if(p){var n=p.text(),w=m.val(),t=w.lastIndexOf(" ")+1;m.val(u=w.substr(0,t)+n);p.removeClass(b);p=null}s.hide()}function d(){if(r.find("li").length){var n=m.offset();s.css({top:n.top+j.offsetHeight,left:n.left,width:j.offsetWidth});s.show()}}var m=k(j),s=k('<div class="auto"><ul></ul></div>').css({display:"none"}).appendTo(document.body),r=s.find("ul"),u="",p=null,v,x=l.clearTimeout;m.bind("change keyup",function(n){var w=m.val();n=n.which;if(n===
f||n===e)g();else if(n===a)s.hide();else if(n===h||n===i){if(p)if(n===h){w=p.prev();if(w.length){p.removeClass(b);p=w.addClass(b)}}else{w=p.next();if(w.length){p.removeClass(b);p=w.addClass(b)}}else p=r.find("li").eq(0).addClass(b);d()}else if(w!==u){u=w;n=w.lastIndexOf(" ");var t=w.substr(n<0?0:n).toLowerCase();if(t.length){v&&x(v);v=l.setTimeout(function(){x(v);v=null;var y=c(t);if(y&&y.length){r.empty();p=null;for(var z=0,A=y.length;z<A;z++)k("<li><span></span></li>").appendTo(r).find("span").html(y[z].split(t,
2).join("<b>"+t+"</b>"));d()}else s.hide()},100)}else s.hide()}}).parent("form").submit(g);r.mouseover(function(n){n=k(n.target);n=n.is("li")?n:n.parent("li");if(n=n.length?n:null){p&&p.get(0)!==n.get(0)&&p.removeClass(b);p=n.addClass(b)}}).click(g)}var h=38,e=39,i=40,f=13,a=27,b="selected",c=q.suggest;k(".search input").each(function(){o(this)});q.autocomplete=o})(window,window["10kse"],jQuery);
(function(l,q,k,o){function h(){var a=(f.val()||"").replace(/^\s+|\s+$/g,""),b=a.toLowerCase().split(/[^a-z0-9_]/),c,j,g={},d,m={};if(a){c=0;for(j=b.length;c<j;c++){a=b[c];if(!m[a])if(a=m[a]=e("W-"+a))for(d in a)g[d]=(g[d]||0)+1}a=k.wordcount;var s=k.normalize,r=k.topdistance;g=[[1,s(g)],[1,s(a(g,b,"s",m))],[1,s(a(g,b,"t",m))],[1,s(a(g,b,"p",m))],[1,s(a(g,b,"c",m))],[1,s(r(g,b,"s",m),-1)],[1,s(r(g,b,"t",m),-1)],[1,s(r(g,b,"p",m),-1)],[1,s(r(g,b,"c",m),-1)]];var u={};c=0;for(j=g.length;c<j;c++){a=
g[c];m=a[0];a=a[1];for(d in a){u[d]||(u[d]=0);u[d]+=m*a[d]}}var p=[];g=0;var v={},x,n;for(d in u){x=u[d];n=v[x]||(v[x]=[]);n[n.length]=d;p[g++]=x}p.sort(k.asc);p.reverse();var w=k.highlight,t=null;i.slideUp("slow",function(){i.empty();c=0;for(j=p.length;c<j;c++){x=p[c];if(x!==t){t=x;n=v[x];for(var y=0,z=n.length;y<z;y++){d=n[y];var A=e("ID-"+d),B=e("URL-"+A),C=B.text;i.append(o("<dt><a></a></dt>").find("a").attr("href",A).attr("title",B.title).html(w(B.title,b,false)).end(),o("<dd><p></p></dd>").find("p").html(w(C,
b)).end().append("<p><strong>Score: "+(u[d]+"").substr(0,4)+"</strong></p>"))}}}i.slideDown("slow")})}}var e=k.get,i=o(".results dl"),f=o(".search input").eq(0);o("form").submit(function(a){a.preventDefault();setTimeout(h,100)});o(function(){f.focus()})})(window,document,window["10kse"],jQuery);
</script>
</body>
</html>

