<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>10k personal search engine</title>
<style type="text/css"></style>
</head>
<body>
<h1>10k personal search engine</h1>
<div class="search">
<h2><span>Search</span></h2>
<form><input type="text" name="search" /></form>
</div>
<div class="results">
<h2><span>Results</span></h2>
<div><dl></dl></div>
</div>
<div class="bookmarklet">
<h2><span>Bookmarklet</span></h2>
<p><a href="" title="Add to search engine" id="add"><span>add</span></a></p>
</div>
<div class="entries">
<h2><span>All pages</span></h2>
<div><p>none yet :/</p></div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>(function(m){var r=m.localStorage,i=m.JSON.stringify,q=m.JSON.parse;m=m["10kse"]={};for(var k="able|about|across|after|all|almost|also|among|and|any|are|because|been|but|can|cannot|could|dear|did|does|either|else|ever|every|for|from|get|got|had|has|have|her|hers|him|his|how|however|into|its|just|least|let|like|likely|may|might|most|must|neither|nor|not|off|often|only|other|our|own|rather|said|say|says|she|should|since|some|than|that|the|their|them|then|there|these|they|this|tis|too|twas|wants|was|were|what|when|where|which|while|who|whom|why|will|with|would|yet|you|your".split("|"),
s={},v=0,c=k.length;v<c;v++)s[k[v]]=true;m.get=function(g){return(g=r.getItem(g))?q(g):g};m.set=function(g,n){return r.setItem(g,i(n))};m.stop=s})(window);
(function(m){m.scanner=function(r,i,q){function k(t,x){var y;if(t.currentStyle)y=t.currentStyle[x];else if(r.getComputedStyle)y=c.getComputedStyle(t,null).getPropertyValue(x);return y}function s(t){return k(t,"display")!=="none"&&k(t,"visiblity")!=="hidden"}function v(t){var x=t.parentNode,y=x.parentNode,A=(t.innerText||t.textContent).replace(f," "),B=A.length;t=1;if(B>25){if(x[b]===q){x[b]=0;g[n++]=x}if(y[b]===q){y[b]=0;g[n++]=x}t+=A.split(",").length;A=B*0.01<<0;t+=A<4?A:3;x[b]+=t;y[b]+=t*0.5}}
var c=i.defaultView,g=[],n=0,b="10score",f=/\s+/g,a,d,e,j,h=i.getElementsByTagName("p");a=0;for(d=h.length;a<d;a++)v(h[a]);h=i.getElementsByTagName("div");var o,p=/<(a|blockquote|dl|div|img|ol|p|pre|table|ul|br)/i;a=0;for(d=h.length;a<d;a++){o=h[a];p.test(o.innerHTML)&&v(o)}p=null;var l;for(a=0;a<n;a++){d=g[a];h=d.getElementsByTagName("a");e=l=0;for(j=h.length;e<j;e++){o=h[e];l+=(o.innerText||o.textContent).length}d[b]=score=d[b]*(1-l/(d.innerText||d.textContent).length);if(!p||score>p[b])p=d}p=p||
i.body;h=i.getSelection()||"";l="h1,h2,h3,h4,h5,h6,pre,code".split(",");o=[];var u,w;a=0;for(d=l.length;a<d;a++){u=i.getElementsByTagName(l[a]);e=0;for(j=u.length;e<j;e++){w=u[e];s(w)&&o.push(w.textContent)}}e=[];p=[p];var z;j=/[a-z][a-z][a-z]/i;for(l=/button|link|noscript|script|style/i;d=p.shift();){u=d.childNodes;a=0;for(d=u.length;a<d;a++){w=u[a];z=w.nodeType;if(z===1&&!l.test(w.tagName)&&s(w))p[p.length]=w;else if(z===3){text=w.nodeValue;if(j.test(text))e[e.length]=text}}}r["10kse"].iframe.contentWindow.postMessage(JSON.stringify({url:i.location.href,
selection:h,title:i.title,priority:o.join(" "),content:e.join(" ")}),"*")}})(window["10kse"]);
(function(m){function r(c){var g,n,b,f=0,a,d={};n=c.split(s);c=0;for(g=n.length;c<g;c++){f++;b=n[c];a=b.toLowerCase();if(b.length>2&&!v[a]){(b=d[a])||(b=d[a]=[]);b[b.length]=f}}return d}function i(c,g,n){if(n&&/[a-z]/i.test(n)){n=r(n);var b,f,a;for(b in n){f=q("W-"+b)||{};(a=f[c])||(a=f[c]={});a[g]=n[b];k("W-"+b,f)}}}var q=m.get,k=m.set,s=/[^0-9a-z_]+/i,v=m.stop;m.extract=r;m.indexer=function(c){var g,n=q("URL-"+c.url);if(n){g=n.id;if(c.content!==n.text||c.title!==n.title)k("URL-"+c.url,{id:g,text:c.content,
title:c.title})}else{g=q("COUNT")||0;k("ID-"+g,c.url);k("COUNT",g+1);k("URL-"+c.url,{id:g,text:c.content,title:c.title})}i(g,"s",c.selection);i(g,"t",c.title);i(g,"p",c.priority);i(g,"c",c.content)}})(window["10kse"],window);
(function(m,r,i,q){var k=q.get,s=q.set,v=r.location.href;k=k("key");if(!k){k=Math.random();s("key",k)}v=JSON.stringify(v.replace(/#.*|$/,"#"+k));i("#add").attr("href",("javascript:("+function(c,g,n){var b=c["10kse"];b||(b=c["10kse"]={});if(b.scanner)return b.scanner();c.addEventListener("message",function(d){if(n.substr(0,d.origin.length)===d.origin){b.scanner=new Function(d.data);b.scanner()}},false);var f=b.iframe=g.createElement("iframe");c=f.style;f.setAttribute("src",n);c.width=c.height="1px";
c.top=c.left="-2px";c.border="none";c.position="absolute";var a=false;f.onload=f.onreadystatechange=function(){if(!a&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){a=true;f.onload=f.onreadystatechange=null;f.contentWindow.postMessage("script",n)}};g.body.appendChild(f)}+")(window,document,"+v+")").replace(/\s+/g," ")).click(function(c){c.preventDefault();alert("1. Drag this link to your bookmarks,\n2. Navigate to another page,\n3. Click the bookmarklet to add that page to your search engine.")});
m!==m.top&&r.location.hash==="#"+k&&m.addEventListener("message",function(c){c.data==="script"?c.source.postMessage("("+q.scanner+")(window,document)","*"):q.indexer(JSON.parse(c.data))},false)})(window,document,jQuery,window["10kse"]);
(function(m,r,i){if(i===i.top){m=m.get;i=m("COUNT")||0;var q,k;if(i>0)for(var s=r("<ul></ul>").appendTo(r(".entries").find("div").empty());i>0;){i--;q=m("ID-"+i);k=m("URL-"+q);r("<li><a></a></li>").find("a").attr("href",q).attr("title",k.title).text(k.title).end().appendTo(s)}}})(window["10kse"],jQuery,window);
(function(m,r,i,q,k){var s=i.get,v=i.stop,c=q(".results dl"),g=q(".search input"),n=q("<div></div>");q("form").submit(function(b){b.preventDefault();var f=(g.val()||"").toLowerCase().split(/[^a-z0-9_]/),a,d,e;b={};var j,h={};a=0;for(d=f.length;a<d;a++){e=f[a];if(!h[e])if(e=h[e]=s("W-"+e))for(j in e)b[j]+=1}c.empty();f=new RegExp("(.*?\\b)("+f.join("|")+")(\\b.*)");for(j in b){d=s("ID-"+j);h=s("URL-"+d);a=h.text;e=[];for(var o=0,p=0,l=a.match(f);l;){e[o++]=l[1];e[o++]=l[2];p+=l[1].length+l[2].length;
a=l[3];l=a.match(f);if(o>10||p>300)break}e[o++]=a;p=q("<dd></dd>");for(a=0;a<o;a++)if(a%2)p.append(q("<strong></strong>").text(e[a]));else{l=e[a];if(l.length>100)l=(a?l.substr(0,47):"")+" ... "+(a<o-1?l.substr(l.length-47):"");p.append(r.createTextNode(l))}c.append(q("<dt><a></a></dt>").find("a").attr("href",d).attr("title",h.title).text(h.title).end(),p)}});q(function(){g.focus()});i.wordcount=function(b,f,a,d){d||(d={});for(var e={},j,h,o,p=0,l=f.length;p<l;p++){j=f[p];if(j.length>2&&!v[j]){j=d[j]||
(d[j]=s("W-"+j));for(h in b)if(o=j[h])if(o=o[a]){if(e[h]===k)e[h]=0;e[h]+=+o.length}}}return e};i.normalize=function(b,f){if(f===k)f=1;var a={},d,e,j,h;for(d in b){h=a[d]=b[d]*f;if(e===k||h>e)e=h;if(j===k||h<j)j=h}for(d in a)a[d]=(a[d]-j)*(1/(e-j));return a};i.highlight=function(b,f){b=n.text(b).html();var a={},d={},e=[],j,h;j=0;for(h=f.length;j<h;j++){var o=f[j],p=o.length;if(p>2&&!a[o]){a[o]=true;for(var l=0,u=0;l<3;){u=b.indexOf(o,u);if(u===-1)break;var w=b.charAt(u-1).toLowerCase(),z=b.charAt(u+
p).toLowerCase();if((w<"a"||w>"z")&&(z<"a"||z>"z")){l++;e[e.length]=u;d[u]=o}u+=p}}}e.sort();a=e[0];return(a>50?"... "+b.substr(a-47,a):b.substr(0,a))+"<b>"+d[a]+"</b>"}})(window,document,window["10kse"],jQuery);
</script>
</body>
</html>

